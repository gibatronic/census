#!/usr/bin/env node

var census = require('../lib/census');
var error = require('../lib/error');
var expandOwnersToRepositories = require('../lib/expand-owners-to-repositories');
var help = require('../lib/help');
var request = require('request');
var version = require('../lib/version');
var yargs = require('yargs');

var main = function(argv) {
  var argv = yargs.alias('h', 'help')
                  .alias('v', 'version')
                  .boolean('h')
                  .boolean('v')
                  .parse(argv);

  if (argv.help) {
    return help();
  }

  if (argv.version) {
    return version();
  }

  if (argv._.length == 0) {
    throw new Error('No owner or repository information was given');
  }

  expandOwnersToRepositories(argv._).then(census).catch(error);
};

try {
  main(process.argv.slice(2));
} catch (exception) {
  error(exception);
}
